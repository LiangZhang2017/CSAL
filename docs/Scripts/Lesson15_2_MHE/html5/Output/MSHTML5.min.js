/*
 Copyright (c) 2012-2014 Media Semantics, Inc.
 Loading spinner is copyright (c) 2011 Felix Gnass.
*/
function msEmbed(l,p,n,z,F){var N=new MSHTML5Control(l,p,n,z,F);N.setCtl(N);"undefined"==typeof msEmbeddings&&(msEmbeddings=[]);msEmbeddings.push(N);for(var R=5;R<arguments.length;R+=2)N[arguments[R]]=arguments[R+1];msEventHelper(N);N.realizeTopLevel(!0).ctl=N}
function msAttach(l,p,n,z,F){var N=new MSHTML5Control(l,p,n,z,F);N.setCtl(N);"undefined"==typeof msEmbeddings&&(msEmbeddings=[]);msEmbeddings.push(N);for(var R=5;R<arguments.length;R+=2)N[arguments[R]]=arguments[R+1];msEventHelper(N);N.realizeTopLevel(!1).ctl=N}
function msEventHelper(l){if(/WebKit/i.test(navigator.userAgent))var p=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(p),l.onPageLoad())},10);else{var n=onload;onload="function"!=typeof onload?function(){l.onPageLoad()}:function(){n&&n();l.onPageLoad()}}var z=onscroll;onscroll="function"!=typeof onscroll?function(){l.onScroll()}:function(){z&&z();l.onScroll()};var F=onmousemove;onmousemove="function"!=typeof onmousemove?function(n){l.onMouseMove(n)}:function(n){F&&
F();l.onMouseMove(n)}}var c;
function MSHTML5Control(l,p,n,z,F){function N(){if(!Ma){var a=document.getElementById(l);qb.spin(a);Ma=!0}}function R(){Ma&&(qb.stop(),Ma=!1)}function Sb(){h.Presenting=1==x.presenting&&!ja;for(var a in x.items){h.Focus=a;break}null==h.Focus&&h.Presenting&&(h.Presenting=!1);x.onload&&(c=h,eval(x.onload),c=null);A("Firing onSceneLoaded("+l+")");"function"==typeof onSceneLoaded&&onSceneLoaded(l);A("Firing onPresentingChange("+l+","+h.Presenting+")");"function"==typeof onPresentingChange&&onPresentingChange(l,
h.Presenting);A("Firing onFocusChange("+l+","+h.Focus+")");"function"==typeof onFocusChange&&onFocusChange(l,h.Focus);Na||K();requestAnimationFrame(Tb)}function rb(a){var e="",d;for(d in a.items){var f=a.items[d];if("character"==f.type)e+=Ub(d,f);else if("bubble"==f.type)e+=Vb(d,f);else if("image"==f.type)var k=d,h=sb(f),e=e+('<div id="'+l+k+'Div" style="position:absolute; display:'+(f.hidden?"none":"block")+"; left:"+h.x+"px; top:"+h.y+"px; width:"+h.cx+"px; height:"+h.cy+'px;"/></div>');else if("movie"==
f.type)k='<div id="'+l+d+'Div" style="position:absolute; left:'+f.left+"px; top:"+f.top+'px;">',k+='<video id="'+l+d+'Video" width="'+f.width+'" height="'+f.height+'"'+(f.autoplay?" autoplay":"")+(f.controls?" controls ":"")+">",k+='<source src="'+V(f.file)+'" type="video/mp4">',f.altfile&&(k+='<source src="'+V(f.altfile)+'" type="video/ogg">'),k+="</video></div>",e+=k;else if("text"==f.type)k="",k+='<div id="'+l+d+'Div" style="position:absolute; display:'+(f.hidden?"none":"block")+"; left:"+f.left+
"px; top:"+f.top+"px; width:"+f.width+"px; height:"+f.height+'px">',k+=f.text,k+="</div>",e+=k;else if("editcontrol"==f.type)var k="",k=k+('<div id="'+l+d+'EditDiv" style="display:block; z-index:999; position:absolute; left:'+f.left+"px; top:"+f.top+'px;" width="'+f.width+'" height="'+f.height+'">'),h="'"+l+"','"+d+"',",t=h+"'editchange'",k=k+('<input id="'+l+d+'Edit" type="text" style="width:'+f.width+"px; height:"+f.height+'px; border-style:none;" onkeyup="msEvent('+t+')" onmouseup="msEvent('+t+
')" onchange="msEvent('+t+')" onfocus="msEvent('+(h+"'editfocus'")+')"/>'),k=k+"</div>",e=e+k;else if("rectangle"==f.type)k="",f.wash?k+='<canvas id="'+l+d+'Wash" style="position:absolute; left:'+f.left+"px; top:"+f.top+'px;" width="'+f.width+'" height="'+f.height+'"/></canvas>':(k+='<div id="'+l+d+'Div" style="position:absolute; left:'+f.left+"px; top:"+f.top+"px; width:"+f.width+"px; height:"+f.height+"px;",f.fillcolor&&(k+=" background-color:"+f.fillcolor+";"),0<f.strokewidth&&(k+=" border:"+f.strokewidth+
"px solid "+f.strokecolor+";"),k+='"></div>'),e+=k;else if("button"==f.type)k="",k+='<div id="'+l+d+'Div" style="position:absolute; left:'+f.left+"px; top:"+f.top+"px; width:"+f.width+"px; height:"+f.height+'px">',h="'"+l+"','"+d+"',",k+='<a href="javascript:msEvent('+(h+"'buttonclick'")+')" onmouseover="msEvent('+(h+"'mouseover'")+')" onmouseout="msEvent('+(h+"'mouseout'")+')" onmousedown="msEvent('+(h+"'mousedown'")+')" onmouseup="msEvent('+(h+"'mouseup'")+')">',k+='<div id="'+l+d+'Inner" style="position:relative; left:0px; top:0px; width:'+
f.width+"; height:"+f.height+'">',k+='<img id="'+l+d+'Back" style="position:absolute; left:0; top:0;" border="0"/>',f.text?k+='<span id="'+l+d+'Lbl" style="position:absolute; left:'+f.xfore+"px; top:"+f.yfore+'px;"/><font>'+f.text+"</font></span>":f.forefile&&(k+='<img id="'+l+d+'Fore" style="position:absolute; left:'+f.xfore+"px; top:"+f.yfore+'px;" border="0"/>'),k+="</div>",k+="</a>",k+="</div>",f.over=!1,f.down=!1,e+=k;else if("grid"==f.type)k=d,s="",s+='<div id="'+l+k+'Div" style="position:absolute; left:'+
f.left+"px; top:"+f.top+"px; width:"+f.width+"; height:"+f.height+'">',s+='<div id="'+l+k+'Inner" style="position:relative; left:0px; top:0px; width:'+f.width+"; height:"+f.height+'">',s+=rb(f),s+="</div>",s+="</div>",e+=s;else if("slideshow"==f.type){h="";h+='<div id="'+l+d+'Div" style="position:absolute; left:'+f.left+"px; top:"+f.top+"px; width:"+f.width+"; height:"+f.height+'">';h+='<div id="'+l+d+'Inner" style="position:relative; left:0px; top:0px; width:'+f.width+"; height:"+f.height+'">';k=
void 0;for(k in f.items)var t="",m=f.items[k],t=t+('<div id="'+l+k+'Div" style="display:none; position:absolute; left:0px; top:0px; width:'+f.width+"; height:"+f.height+';">'),t=t+('<div id="'+l+k+'Inner" style="position:relative; left:0px; top:0px; width:'+f.width+"; height:"+f.height+';">'),t=t+rb(m),t=t+"</div>",t=t+"</div>",h=h+t;h+="</div>";h+="</div>";e+=h}else"buttonset"==f.type&&(k="",k+='<div id="'+l+d+'Div" style="position:absolute; left:'+f.left+"px; top:"+f.top+'px;">',k+='<div id="'+
l+d+'Inner" style="position:relative; left:0px; top:0px;" width="'+(f.width+5)+'" height="'+(f.height+8)+'">',k+="</div>",k+="</div>",e+=k)}return e}function Ub(a,e){var d="",f="'"+l+"','"+a+"',",k=f+"'audioonloadstart'",h=f+"'audioonprogress'",t=f+"'audiooncanplaythrough'",L=f+"'audioonerror'",u=f+"'audioonstalled'",q=f+"'audioonloadedmetadata'",n=f+"'audioonplaying'",p=f+"'audioonended'",f=f+"'audioontimeupdate'";e.narrator&&(e.left=e.top=e.width=e.height=0);var C=sb(e),d=d+('<div id="'+l+a+'Div" style="position:absolute; left:'+
C.x+"px; top:"+C.y+"px; width:"+C.cx+"; height:"+C.cy+'">'),d=d+('<canvas id="'+l+a+'Canvas" width="'+C.cx+'" height="'+C.cy+'"></canvas>'),d=d+('<audio id="'+l+a+'Audio" onloadstart="msEvent('+k+')" onprogress="msEvent('+h+')" oncanplaythrough="msEvent('+t+')" onerror="msEvent('+L+')" onstalled="msEvent('+u+')" onloadedmetadata="msEvent('+q+')" onplaying="msEvent('+n+')" onended="msEvent('+p+')" ontimeupdate="msEvent('+f+')"/>');m[a]={idScene:e.parent.id,aImg:null,aImgShow:null,cxCharLeft:C.cxLeft,
cyCharTop:C.cyTop,charCanvas:null,loadingAudio:!1,audioLoaded:!1,idMsg:null,idMsgNext:null,complete:!1};return d+"</div>"}function sb(a){var e=0,d=parseInt(a.left),f=parseInt(a.width);0>d&&(e=-d,f+=d,d=0);d+f>z&&(f=z-d);var k=0,h=parseInt(a.top);a=parseInt(a.height);0>h&&(k=-h,a+=h,h=0);h+a>F&&(a=F-h);return{cxLeft:e,cyTop:k,x:d,y:h,cx:f,cy:a}}function Vb(a,e){var d;d=""+('<div id="'+l+a+'Div" style="position:absolute; left:'+e.left+"px; top:"+e.top+'px;">');d+='<div id="'+l+a+'Inner" style="position:relative; left:0px; top:0px;" width="'+
(e.width+5)+'" height="'+(e.height+8)+'">';d+='<canvas id="'+l+a+'Canvas" style="position:absolute; left:0px; top:0px;" width="'+(e.width+5)+'" height="'+(e.height+8)+'"></canvas>';d+='<div id="'+l+a+'Text" style="position:absolute; left:5px; top:5px; width:'+(parseInt(e.width)-10)+"px; height:0px;";d+="font-family:"+e.fontname+"; font-size:"+e.fontheight+"px;";d+="font-color:"+e.fontcolor+";";e.fontbold&&(d+=" font-weight:bold;");e.fontitalic&&(d+=" font-style:italic;");d+='"></div>';d+="</div>";
return d+="</div>"}function Dc(a,e){if(null!=e){abtn=[];for(var d=1;d<=a.frames;d++){var f=a.onframe[d.toString()];if(f)for(var k=0,k=f.indexOf("c.button('",k);-1!=k;){var k=k+10,h=f.indexOf("'",k);-1!=h&&(abtn.push({text:f.substr(k,h-k)}),k=h+1);k=f.indexOf("c.button('",k)}}e.abtn=abtn;k=document.getElementById(l+"Measure");k.style.fontFamily=e.fontname;k.style.fontSize=e.fontheight+"px";for(var h=0,t,d=0;d<abtn.length;d++)k.innerHTML=abtn[d].text,t=k.clientHeight,k.clientWidth>h&&(h=k.clientWidth),
abtn[d].width=k.clientWidth,abtn[d].height=k.clientHeight;k=h+2*e.padding;t+=2*e.padding;h=Math.floor(e.width/(k+e.padding));d=Math.ceil(abtn.length/h);1==d&&(h=abtn.length);for(var m=h*k+(h-1)*e.spacing,u=0,q=0,n=(e.width-m)/2,p=(e.height-(d*t+(d-1)*e.spacing))/2,f="",d=0;d<abtn.length;d++){var C=e.id,w=abtn[d],y="",y=y+('<div id="'+l+C+"Btn"+d+'Div" style="position:absolute; left:'+n+"px; top:"+p+"px; width:"+k+"px; height:"+t+'px">'),D="'"+l+"','"+C+"',",y=y+('<a href="javascript:msEvent('+(D+
"'bsbuttonclick',"+d)+')" onmousedown="msEvent('+(D+"'bsmousedown',"+d)+')" onmouseup="msEvent('+(D+"'bsmouseup',"+d)+')">'),y=y+('<div id="'+l+C+"Btn"+d+'Inner" style="position:relative; left:0px; top:0px; width:'+k+"px; height:"+t+'px;">'),y=y+('<canvas id="'+l+C+"Btn"+d+'Up" style="display:none; position:absolute; left:0px; top:0px;" width="'+k+'" height="'+t+'"></canvas>'),y=y+('<canvas id="'+l+C+"Btn"+d+'Dn" style="display:none; position:absolute; left:0px; top:0px;" width="'+k+'" height="'+
t+'"></canvas>'),y=y+('<span id="'+l+C+"Btn"+d+'Lbl" style="display:none; position:absolute; left:'+(k-w.width-1)/2+"px; top:"+(t-w.height)/2+'px;"/><font>'+w.text+"</font></span>"),y=y+"</div>",y=y+"</a>",y=y+"</div>",f=f+y;q++;n+=k+e.padding;q==h&&(u++,p+=t+e.padding,q=0,n=(e.width-m)/2)}document.getElementById(l+e.id+"Inner").innerHTML=f;for(d=0;d<abtn.length;d++)Wb(document.getElementById(l+e.id+"Btn"+d+"Up"),k,t,e,!1),Wb(document.getElementById(l+e.id+"Btn"+d+"Dn"),k,t,e,!0)}}function Wb(a,e,
d,f,k){var h=Math.ceil(f.linewidth/2);e-=2*h;d-=2*h;var l=a.getContext("2d");l.clearRect(0,0,e,d);l.lineWidth=parseInt(f.linewidth);l.strokeStyle=f.linecolor;k=k?f.facecolordown:f.facecolor;f=f.faceopacity;k=k.replace("#","");r=parseInt(k.substring(0,2),16);g=parseInt(k.substring(2,4),16);b=parseInt(k.substring(4,6),16);result="rgba("+r+","+g+","+b+","+f/100+")";l.fillStyle=result;l.beginPath();l.moveTo(h+10,h);l.arcTo(h+e,h,h+e,h+10,10);l.arcTo(h+e,h+d,h+e-10,h+d,10);l.arcTo(h,h+d,h,h+d-10,10);l.arcTo(h,
h,h+10,h,10);l.closePath();l.stroke();l.fill();return a}function Ec(a,e){var d=q[a],f=d.abtn[e].text;d.variable&&(h[d.variable]=f);if(d=d.onclick)c=h,eval(d),c=null;document.getElementById(l+a+"Inner").innerHTML=""}function Xb(a,e){for(var d in a.items){var f=a.items[d];q[d]=f;f.id=d;f.parent=a;f.hasOwnProperty("items")&&Xb(f,d)}}function P(a){var e;return q[a]?a:G&&(e=Oa(q[G],a))||B&&(e=Oa(q[B],a))?e:Oa(x,a)}function Oa(a,e){for(var d in a.items){var f=a.items[d];if(f.name==e)return d;if(f=Oa(f,
e))return f}return null}function Q(a){try{console.log(l+": "+((new Date).getTime()-Yb)/1E3+"s: "+a)}catch(e){}}function A(a){if(0<traceLevel)try{console.log(l+": "+((new Date).getTime()-Yb)/1E3+"s: "+a)}catch(e){}}function tb(a){a||Q("Internal Error")}function Y(a,e){for(var d in e.items)if(e.items[d].type==a)return d;return null}function ub(a,e){for(var d=e.parent;d;){if(d&&d.type==a)return d;d=d.parent}}function ua(a,e){var d=ub(a,q[e]);return d?d.id:null}function vb(a,e){if(null==e)return null;
var d=Y(a,e);if(d){var f,d=q[d],k=null;for(f in d.items)k=d.items[f];if(f=k)return f}return null}function wb(a){var e=!1,d;for(d in a.parent.items){if(e)return a.parent.items[d];a.parent.items[d]==a&&(e=!0)}return null}function xb(a){var e=null,d;for(d in a.parent.items){if(a.parent.items[d]==a)return e;e=a.parent.items[d]}}function Pa(){var a=!0,e=!1,d;for(d in m)m[d].idScene==B&&(m[d].started||(e=!0),m[d].started&&!m[d].complete&&(a=!1));da&&(a=!1);W&&(a=!1);if(a){a=!1;for(d in m)m[d].idScene==
B&&(e&&null!=m[d].idMsg&&null==m[d].idMsgNext||(m[d].idMsg=m[d].idMsgNext,m[d].idMsgNext=null,null==m[d].idMsg&&(a=!0)),m[d].started=!1,m[d].complete=!1,Qa());a&&(e=h.Presenting,h.Presenting=!1,Qa(),0==h.Presenting&&0<X.length?(d=X.shift(),yb(),"play"==d.type?(h.Focus=d.data,h.Presenting="true",A("Playing from queue with: "+h.Focus),K()):"speak"==d.type&&(h.Text=d.data,h.Focus=P("Speak"),h.Presenting="true",A("Speaking from queue with: "+h.Text),K()),d=!0):d=!1,d||(e!=h.Presenting&&(A("Firing onPresentingChange("+
l+","+h.Presenting+")"),"function"==typeof onPresentingChange&&onPresentingChange(h,h.Presenting)),Qa(),Z(x),Ea()));requestAnimationFrame(Ra)}}function Sa(a){var e=x,d;for(d in e.items)for(var f in e.items[d].items){var k=e.items[d].items[f];if("message"==k.type&&1==k.idle&&k.character==a)return f}return null}function V(a){return n&&a?n+"/"+a:a}function Zb(a){var e=a.url;if(void 0!=a.addvariables){if(-1!=a.addvariables.indexOf("AIMLUser")){var d=new Date;d.setTime(d.getTime()+31536E6);d.toGMTString();
if(!h.AIMLUser)if(d=$b("AIMLUser"))h.AIMLUser=d,A("Returning with aimluser "+d);else{d="User";for(i=0;10>i;i++)d+=Math.floor(9*Math.random())+1;A("Creating aimluser "+d);h.AIMLUser=d;ac("AIMLUser",d,365)}if(!h.AIMLSession){d="Session";for(i=0;10>i;i++)d+=Math.floor(9*Math.random())+1;A("Creating aimlsession "+d);h.AIMLSession=d}!h.AIMLSequence&&h.AIMLSession&&(h.AIMLSequence=1);h.AIMLTimezone||(h.AIMLTimezone=(new Date).getTimezoneOffset())}var d=!1,f;for(f in m)if(m[f].idScene==B){f=document.getElementById(l+
f+"Audio");!f.canPlayType("audio/mp3")&&f.canPlayType("audio/ogg")&&(d=!0);break}e+="&genogv="+(d?"true":"false");a=a.addvariables.split(",");for(f=0;f<a.length;f++){var d=h[a[f]],k=void 0==d?"":d.toString();0<d.length&&(e+="&"+a[f]+"="+encodeURIComponent(k))}}return e}function ac(a,e,d){if("function"==typeof onWriteCookie)return onWriteCookie(a,e,d);if(d){var f=new Date;f.setTime(f.getTime()+864E5*d);d="; expires="+f.toGMTString()}else d="";document.cookie=a+"="+e+d+"; path=/"}function $b(a){if("function"==
typeof onReadCookie)return onReadCookie(a);a+="=";for(var e=document.cookie.split(";"),d=0;d<e.length;d++){for(var f=e[d];" "==f.charAt(0);)f=f.substring(1,f.length);if(0==f.indexOf(a))return f.substring(a.length,f.length)}return null}function Ta(a){var e="",d=bc(n);"https://"==d.substr(0,8)?(d=d.substr(8),e=d.substr(0,d.indexOf("/"))):"http://"==d.substr(0,7)&&(d=d.substr(7),e=d.substr(0,d.indexOf("/")));d="";"https://"==a.substr(0,8)?(d=a.substr(8),d=d.substr(0,d.indexOf("/"))):"http://"==a.substr(0,
7)&&(d=a.substr(7),d=d.substr(0,d.indexOf("/")));return""!=d&&""!=e&&d!=e?(temparray=a.split(d),salt=temparray.join(e)):a}function bc(a){null==Ua&&(Ua=document.createElement("a"));Ua.href=a;return Ua.href}function Ra(){0<ka.length&&Q("code 4");ka=[];for(var a in m)m[a].idScene==B&&ka.push(a);0<ka.length?(a=ka.pop(),cc(a)):zb()}function cc(a){var e=m[a].idMsg,d=q[e];if(d)if(d.datafile)Va=e,a=document.createElement("script"),document.getElementById(l).appendChild(a),a.src=n+"/"+d.datafile;else if(d.external)if("function"!=
typeof jQuery)Q("jQuery required for external messages");else if(null!=va)A("Already have an outstanding server request! Ignoring.");else{va=a;Wa=e;var f;f=Ta(Zb(d));h.AIMLSequence&&(f+="&AIMLSequence="+h.AIMLSequence,h.AIMLSequence++);f+="&callback=?";A("Calling "+f);$.ajax({url:f,data:{},dataType:"jsonp",success:function(a){for(var d in a){wa=a[d];wa.id=d;break}Ab(va,Wa);Wa=va=null},error:function(){Q("Error calling "+f);Wa=va=I=null;h.Presenting=!1}})}else wa=null,Ab(a,e);else I=a,Xa()}function Ab(a,
e){var d=q[e],f;f=1==d.idle?d:d.external?wa:d;h.Presenting&&Dc(f,dc(a));var k=q[d.character];I=a;m[a].charCanvas||"replace"!=k.mode||k.width==k.artwidth||(m[a].charCanvas=document.createElement("canvas"),m[a].charCanvas.height=k.artheight,m[a].charCanvas.width=k.artwidth,m[a].cyCharTop=0,m[a].cxCharLeft=0);E=1;ec(m[a].aImg);m[a].aImg=null;H={};f&&f.onframe&&f.onframe["0"]&&(Ya=d.external?Ta(d.url):null,O=e,v=a,c=h,eval(f.onframe["0"]),Ya=v=O=c=null);for(i in H);E--;0==E&&Xa()}function Fc(a,e){var d=
a.indexOf("cs.exe");return-1!=d?a.substr(0,d-1)+"html/"+e:null}function Bb(){E--;0>E&&(Q("code 3"),E=0);W&&0==E?Cb():da&&0==E?Db():I&&0==E&&Xa()}function T(a){return"object"==typeof a&&a.hasOwnProperty("msvector")}function Za(){nAudio=0;for(idChar in m)m[idChar].idScene==B&&m[idChar].loadingAudio&&nAudio++;return nAudio}function fc(a){m[a].loadingAudio=!1;a=Za();if(a=null==W&&0==ka.length&&null==I&&0==a){var e;a:{for(e in m)if(m[e].idMsgNext){e=!0;break a}e=!1}a=!e}a&&zb()}function Xa(){var a=I;I=
null;m[a].aImg=H;H={};m[a].aImgShow=[];m[a].started=!1;m[a].complete=!1;m[a].fRecovering=!1;m[a].action="";m[a].fStopReached=!1;0<ka.length?(a=ka.pop(),cc(a)):0==Za()&&zb()}function zb(){la=-1;gc(0);I=null;R();Na=!1;if(Eb)Eb=!1,K();else{if(h.Presenting)for(idChar in m){if(m[idChar].idScene==B){var a=document.getElementById(l+idChar+"Audio");hc(a)}}else for(idChar in m)m[idChar].idScene==B&&(a=document.getElementById(l+idChar+"Audio"),Fa(a));ma=0;pa=na=(new Date).getTime()}}function hc(a){"function"==
typeof onAudioPlay?onAudioPlay():a.play()}function Fa(a){"function"==typeof onAudioPause?onAudioPause():a.pause()}function Fb(a){var e;if(a)for(e=0;e<qa.length;e++)if(qa[e].src==a)return a=qa[e],qa.splice(e,1),a;return 0<qa.length?(a=qa.shift(),a.src="",a.data=null,a):new Image}function ec(a){for(var e in a){var d=a[e];d.onload=null;qa.push(d);delete a[e]}}function $a(a){for(var e in a.items){var d=a.items[e];if("image"==d.type)d=V(d.file),H[e]=Fb(null),H[e].onload=function(){Bb()},E++,H[e].src=d;
else if("button"==d.type)for(var f="backfile backoverfile backdownfile backdisabledfile backchosenfile forefile foreoverfile foredisabledfile forechosenfile".split(" "),k=0;k<f.length;k++)d[f[k]]&&(H[e+f[k]]=Fb(null),H[e+f[k]].onload=function(){Bb()},E++,H[e+f[k]].src=V(d[f[k]]));else"character"!=d.type||d.narrator?"grid"==d.type?$a(d):"slideshow"==d.type&&(d=d.items[G])&&$a(d):(d=Sa(e),f=q[d],ab=1,v=e,O=d,c=h,eval(f.onframe["0"]),O=v=c=null,ab=0)}}function Cb(){tb(B==W);W=null;R();Z(x);xa(B);ic(B);
G&&xa(G);bb(x.items[B]);Gb(B);G&&Gb(G);var a;Ga&&(a=document.getElementById(l+Ga+"Div"),a.style.display="none");a=document.getElementById(l+B+"Div");a.style.display="block";h.Preview&&(document.getElementById(l+"PreviewDiv").style.display="block");H={};G&&(a=document.getElementById(l+G+"Div"),a.style.display="block");M&&xa(M);ya=Ga=null;ja||Ra()}function ic(a){a=q[a];for(var e in a.items){var d=a.items[e];"grid"==d.type&&xa(d.id)}}function Gb(a){a=q[a];for(var e in a.items){var d=a.items[e];d.snaptoparent&&
(h.setPosition(d.id,0,0),h.setSize(d.id,h.getWidth(a.parent.id),h.getHeight(a.parent.id)))}}function xa(a){if(a=q[a].onshow)c=h,eval(a),c=null}function bb(a){for(var e in a.items){var d=a.items[e];if("image"==d.type){var f=document.getElementById(l+e+"Div"),k=sb(d);f.style.background="url("+V(d.file)+") -"+k.cxLeft+"px -"+k.cyTop+"px";f.style.backgroundSize=d.width+"px "+d.height+"px"}else if("button"==d.type)ea(e);else if("character"==d.type&&!d.narrator){f=Sa(e);k=q[f];cb(e);m[e].aImg={};m[e].aImgShow=
[];for(var oa in H)f==oa.substr(0,f.length)&&(m[e].aImg[oa]=H[oa]);v=e;O=f;c=h;eval(k.onframe["1"]);O=v=c=null;aa&&Hb(e,f);"replace"==d.mode&&d.width!=d.artwidth&&(m[e].charCanvas=document.createElement("canvas"),m[e].charCanvas.height=d.artheight,m[e].charCanvas.width=d.artwidth,m[e].cyCharTop=0,m[e].cxCharLeft=0);m[e].charCanvas&&jc(e);ec(m[e].aImg);m[e].aImg=null;m[e].aImgShow=null}else if("grid"==d.type)bb(d);else if("slideshow"==d.type){var t,L;for(L in d.items){t=d.items[L];break}t&&bb(t)}}}
function Db(){tb(da==G);da=null;R();var a=q[G];bb(a);var e=ya?document.getElementById(l+ya+"Div"):null,d=document.getElementById(l+G+"Div");Gb(G);xa(G);ic(G);a=a.transition;"cross"!=a||ya||(a="simple");"cross"==a?(fade={from:e,to:d,cms:500,tStart:(new Date).getTime()},fa.push(fade),db||eb()):"simple"==a?(e&&(e.style.display="none"),kc(d,500)):(e&&(e.style.display="none"),d.style.display="block");H={};ya=Ga=null;Pa()}function kc(a,e){fade={from:null,to:a,cms:e,tStart:(new Date).getTime()};fa.push(fade);
db||eb()}function eb(){for(var a=(new Date).getTime(),e=!1,d=0;d<fa.length;d++){var f=fa[d].from,k=fa[d].to,h=(a-fa[d].tStart)/fa[d].cms;1>h?(f&&(f.style.display="block"),k&&(k.style.display="block"),f&&(f.style.opacity=1-h),k&&(k.style.opacity=h),e=!0):(f&&(f.style.display="none"),k&&(k.style.display="block"),fa.splice(d,1),d--)}e?requestAnimationFrame(eb):db=!1}function ea(a){var e=q[a],d="backfile",f="forefile",k=e.xfore,h=e.yfore,t=!1,m,u;e.disabled?e.hideondisabled?t=!0:(m="backdisabledfile",
e[m]&&(d=m),m="foredisabledfile",e[m]&&(f=m)):e.chosen?(m="backchosenfile",u="backoverfile",e[m]?d=m:e[u]&&(d=u),m="forechosenfile",u="foredownfile",e[m]?f=m:e[u]&&(f=u)):e.over&&!e.down?(m="backoverfile",e[m]&&(d=m),m="foreoverfile",e[m]&&(f=m)):e.over&&e.down&&(m="backdownfile",e[m]&&(d=m),m="foreoverfile",e[m]&&(f=m),k=parseInt(e.xfore)+parseInt(e.xdown),h=parseInt(e.yfore)+parseInt(e.ydown));document.getElementById(l+a+"Div").style.display=t?"none":"block";t=document.getElementById(l+a+"Back");
e[d]&&(t.src=V(e[d]));if(a=document.getElementById(l+a+"Fore"))e[f]&&(a.src=V(e[f])),a.style.left=k+"px",a.style.top=h+"px"}function Qa(){for(idChar in m);}function ra(){var a=q[h.Focus];if(null==a)Q("Invalid Focus value "+h.Focus+" - ignoring!"),h.Presenting=!1;else if(a=a.type,"scene"==a){B=h.Focus;if(G=(fb=Y("slideshow",q[B]))?Ha?Ha:Y("slide",q[fb]):null)h.Focus=G,Ha=null;M=(za=Y("sequence",q[G?G:B]))?ga?ga:Y("step",q[za]):null;null!=M&&(h.Focus=M,ga=null);Ea();U&&(h.Focus=U,U=null)}else if("slide"==
a){if((a=ua("scene",h.Focus))&&a!=B)return Ha=h.Focus,h.Focus=a,ra();G=h.Focus;if(M=(za=Y("sequence",q[G]))?ga?ga:Y("step",q[za]):null)h.Focus=M,ga=null;Ea()}else if("step"==a){if((a=ua("slide",h.Focus))&&a!=G||(a=ua("scene",a))&&a!=B)return ga=h.Focus,h.Focus=a,ra();M=h.Focus;Ea()}else if("message"==a||"dialog"==a){if((a=ua("step",h.Focus))&&a!=M||(a=ua("slide",h.Focus))&&a!=G||(a=ua("scene",h.Focus))&&a!=B)return U=h.Focus,h.Focus=a,ra();U=h.Focus;Ea()}}function Ea(){var a=!0;for(idChar in m)if(m[idChar].idScene==
B){var e=null;h.Presenting?(M?e=gb(M,idChar):G?e=gb(G,idChar):B&&(e=gb(B,idChar)),null==e?e=Sa(idChar):a=!1):e=Sa(idChar);m[idChar].idMsg?m[idChar].idMsgNext=e:m[idChar].idMsg=e}U=null;a&&(h.Presenting=!1)}function gb(a,e){var d=q[a],f=null,k;for(k in d.items){var l=d.items[k];if("message"==l.type&&l.character==e&&!l.idle){if(k==U)return k;var m=!0;l.condition&&(c=h,m=eval(l.condition),c=null);m&&!f&&(f=k)}else if("dialog"==l.type&&(null==U||U==k)){f=gb(k,e);break}}return f}function lc(){var a;return M&&
(a=wb(q[M]))||G&&(a=wb(q[G]))||B&&!x.focusisland&&(a=wb(q[B]))?a.id:null}function mc(){var a;if(M&&(a=xb(q[M])))return a.id;if(G){a=xb(q[G]);var e=vb("sequence",a);e&&(a=e);if(a)return a.id}return B&&!x.focusisland&&(a=xb(q[B]),(e=vb("slideshow",a))&&(a=e),(e=vb("sequence",a))&&(a=e),a)?a.id:null}function K(){if(Na)Eb=!0;else{Na=!0;var a=B,e=G,d=M;for(idChar in m)if(m[idChar].idScene==B&&!h.Presenting){var f=document.getElementById(l+idChar+"Audio");f&&Fa(f)}Ga=B;ya=G;ga=Ha=U=null;ra();for(idChar in m)if(m[idChar].idScene==
B&&(f=m[idChar].idMsgNext,null==f&&(f=m[idChar].idMsg),f)){var f=q[f],k,oa;f.external?(f=Zb(f),h.AIMLSequence&&(f+="&AIMLSequence="+h.AIMLSequence),k=Ta(f+"&MP3Prefetch=true"),oa=Ta(f+"&OGVPrefetch=true")):(k=V(f.file),oa=V(f.altfile));var f=idChar,t=document.getElementById(l+f+"Audio");ba||Ia||hb||t.canPlayType("audio/mp3")||!t.canPlayType("audio/ogg")||(k=oa);k?m[f].loadingAudio||(t.autoplay=!0,"function"==typeof onAudioLoad?onAudioLoad(k):(t.src=k,t.load(),m[f].loadingAudio=!0)):(ma=0,pa=na=(new Date).getTime(),
m[f].loadingAudio=!1)}Qa();Z(x);if(B!=a){N();W=B;E=1;H={};$a(q[W]);for(var L in H);E--;0==E&&Cb()}else if(G!=e){N();tb(!W&&!da&&!I);da=G;E=1;H={};$a(q[G]);for(var u in H);E--;0==E&&Db();Z(x)}else M!=d&&Z(x);M&&xa(M);Pa()}}function Z(a){for(id in a.items)if(obj=a.items[id],"button"==obj.type){var e=obj.behavior;if(e){switch(e){case "start":obj.disabled=h.Presenting;break;case "stop":obj.disabled=!h.Presenting;break;case "next":obj.disabled=null==lc();break;case "previous":case "first":obj.disabled=
null==mc();break;case "pause":obj.disabled=!(h.Presenting&&!h.Paused);break;case "resume":obj.disabled=!(h.Presenting&&h.Paused);break;case "mute":obj.disabled=h.Muted;break;case "unmute":obj.disabled=!h.Muted}ea(id)}}else obj.hasOwnProperty("items")&&Z(obj)}function nc(a){for(var e in a.items){var d=a.items[e];if("rectangle"==d.type){if(d.wash){var f=document.getElementById(l+d.id+"Wash").getContext("2d"),k=f.createLinearGradient(0,0,"horizontal"==d.wash?d.width:0,"vertical"==d.wash?d.height:0);
k.addColorStop(0,d.fillcolor1);k.addColorStop(1,d.fillcolor2);f.fillStyle=k;f.fillRect(0,0,d.width,d.height)}}else"slideshow"!=d.type&&"slide"!=d.type&&"grid"!=d.type||nc(d)}}function Gc(a,e,d,f){var k=document.getElementById(l+"Measure"),h="",m=0,L=0;k.style.fontFamily=a.fontname;for(k.style.fontSize=a.fontheight+"px";0<e.length;){e=e.trim();var u=0;for(a=0;u<e.length;){for(;u<e.length&&" "!=e.substr(u,1)&&"-"!=e.substr(u,1);)u++;"-"==e.substr(u,1)&&u++;for(iTest=u;u<e.length&&" "==e.substr(u,1);)u++;
k.innerHTML=e.substr(0,iTest);if(k.clientWidth>d)break;else a=iTest}0==a&&(a=iTest);u=h;0<u.length&&(u+="<br/>");u+=e.substr(0,a);k.innerHTML=u;if(k.clientHeight<f||0==m)h=u,m++,e=e.substr(a),L=k.clientHeight;else break}a={text:h,height:L,remain:e};k.innerHTML="";return a}function oc(a,e){var d=Gc(a,e,a.width-12,a.height-10-a.tailheight);0<d.remain.length&&(Ja=d.remain);var f=a.width-4,k=1==a.tailstyle?parseInt(a.tailheight):0,h=2==a.tailstyle?parseInt(a.tailheight):0,m=1==a.autosize?a.height:d.height+
10+parseInt(a.tailheight);2==a.tailstyle&&(m-=13);var L=1==a.tailstyle?3==a.autosize?parseInt(a.height)-m:2:h+8,u=f*parseInt(a.tailattach)/100;15>u&&(u=15);u>f-15&&(u=f-15);var q=parseInt(a.tailskew),n=parseInt(a.tailwidth),p=document.getElementById(l+a.id+"Canvas"),C=p.getContext("2d");C.clearRect(0,0,p.width,p.height);ba&&Aa(p);C.lineWidth=2*parseInt(a.linewidth);C.strokeStyle=a.linecolor;C.fillStyle=a.bubblecolor;C.beginPath();C.moveTo(12,L);"2"==a.tailstyle&&(C.lineTo(2+u-n/2,L),C.lineTo(2+u+
q,L-h),C.lineTo(2+u+n/2,L));C.lineTo(2+f-10,L);C.arcTo(2+f,L,2+f,L+10,10);C.lineTo(2+f,L+m-k-10);C.arcTo(2+f,L+m-k,2+f-10,L+m-k,10);"1"==a.tailstyle&&(C.lineTo(2+u+n/2,L+m-k),C.lineTo(2+u+q,L+m),C.lineTo(2+u-n/2,L+m-k));C.lineTo(12,L+m-k);C.arcTo(2,L+m-k,2,L+m-k-10,10);C.lineTo(2,L+10);C.arcTo(2,L,12,L,10);C.closePath();C.stroke();C.fill();f=document.getElementById(l+a.id+"Text");f.style.top=L+5+"px";f.innerHTML=d.text;document.getElementById(l+a.id+"Div").style.display="block";a.timer&&clearTimeout(a.timer);
d=Hc(d.text,a);a.timer=setTimeout(function(){a.timer=0;if(0<Ja.length){var d=Ja;Ja="";oc(a,d)}else document.getElementById(l+a.id+"Div").style.display="none"},d)}function Hc(a,e){var d=a.split(" ").length;return e.minshow+6E4*d/e.wpm}function dc(a){a=ub("scene",q[a]);for(var e in a.items){var d=a.items[e];if("buttonset"==d.type)return d}return null}function pc(){var a=h.Muted?0:1;for(charid in m)if(m[idChar].idScene==B){var e=document.getElementById(l+idChar+"Audio");e&&(e.volume=a)}}function ib(a){for(var e=
1;2>=e;e++){var d=q[B],f=1,k;for(k in d.items){var h=d.items[k];if("message"==h.type&&h.text){if(1==a)return ha=1,h.text;if(2==a&&ha+1==f||3==a&&ha-1==f)return ha=f,h.text;if(4==a&&ha==f)return h.id;f++}}if(1==a||4==a)return"";2==a?ha=0:3==a&&(ha=f)}ha=1;return""}function Ka(a){a=P(a);return document.getElementById(l+a+"Video")}function ca(a){return document.getElementById(l+a+"Div")}function cb(a){aa=!1;Ba=Ca=0;a=q[a];jb=a.width;kb=a.height}function qc(a,e){for(var d=m[a].aImgShow,f=0;f<d.length;f++)if(d[f]==
e)return;d.push(e)}function Aa(a){a.style.display="none";a.offsetHeight;a.style.display="inherit"}function jc(a){var e=q[a];if(m[a].charCanvas){var d=document.getElementById(l+a+"Canvas");if(d.getContext){var f=d.getContext("2d");f.imageSmoothingEnabled=!0;f.clearRect(0,0,parseInt(e.width),parseInt(e.height));ba&&Aa(d);f.drawImage(m[a].charCanvas,0,0,e.artwidth,e.artheight,0,0,parseInt(e.width),parseInt(e.height))}}}function Hb(a,e){var d=m[a].charCanvas?m[a].charCanvas:document.getElementById(l+
a+"Canvas");if(d.getContext){var f=d.getContext("2d");f.clearRect(0,0,d.width,d.height);ba&&Aa(d);for(var k=0;k<m[a].aImgShow.length;k++){var h=m[a].aImgShow[k],t=m[a].aImg[h];if(t&&(T(t)||t.src))if(T(t)){var n=t.n,u=t.x,p=t.y,x,v=q[a];x=v.width/v.artwidth;var C=t.rx,w=t.ry,y=t.rn;if(t.morph)a:{var v=f,D=t.data,A=t.morph,B=m[a].aImg[e+t.morph].data,t=n,u=u-10*m[a].cxCharLeft,n=p-10*m[a].cyCharTop,p=x,G=w,H=y;v.fillStyle="rgba(0,0,0,100)";v.strokeStyle="rgba(0,0,0,100)";v.lineWidth=1;var z=x=w=y=0,
E=0,F=0,O=0,P=0,M=0,N=0,K=0,I=0,R=D.frames[0],B=B.frames[0];if(R.length!=B.length)Q("Tween fail - "+h+" -> "+A+" - lengths differ");else for(var J=void 0,S=void 0,D=rc(p,u/10-D.xView/10*p,n/10-D.yView/10*p,C,G,H),u=0;u<R.length;u++){J=R[u];S=B[u];if(J[0]!=S[0]){Q("Tween fail - "+h+" -> "+A+" - "+J+" vs "+S);break a}switch(J[0]){case "lw":v.lineWidth=J[1]/10*p;break;case "fs":v.fillStyle="rgba("+J[1]+","+J[2]+","+J[3]+","+J[4]/100+")";break;case "ss":v.strokeStyle="rgba("+J[1]+","+J[2]+","+J[3]+","+
J[4]/100+")";break;case "bp":v.beginPath();N=M=I=xN=z=x=F=E=0;break;case "m":E=J[1];F=J[2];K=S[1];I=S[2];xA=E+(K-E)*t/100;yA=F+(I-F)*t/100;v.moveTo(D.a*xA+D.c*yA+D.e,D.b*xA+D.d*yA+D.f);break;case "l":E=J[1];F=J[2];K=S[1];I=S[2];xA=E+(K-E)*t/100;yA=F+(I-F)*t/100;v.lineTo(D.a*xA+D.c*yA+D.e,D.b*xA+D.d*yA+D.f);break;case "b":7==J.length?(y=J[1],w=J[2],x=J[3],z=J[4],E=J[5],F=J[6]):(y=E-(x-E),w=F-(z-F),x=J[1],z=J[2],E=J[3],F=J[4]);7==S.length?(O=S[1],P=S[2],M=S[3],N=S[4],K=S[5],I=S[6]):(O=K-(M-K),P=I-(N-
I),M=S[1],N=S[2],K=S[3],I=S[4]);5==J.length&&7==S.length?(O=K-(M-K),P=I-(N-I)):7==J.length&&5==S.length&&(y=E-(x-E),w=F-(z-F));x1A=y+(O-y)*t/100;y1A=w+(P-w)*t/100;x2A=x+(M-x)*t/100;y2A=z+(N-z)*t/100;xA=E+(K-E)*t/100;yA=F+(I-F)*t/100;v.bezierCurveTo(D.a*x1A+D.c*y1A+D.e,D.b*x1A+D.d*y1A+D.f,D.a*x2A+D.c*y2A+D.e,D.b*x2A+D.d*y2A+D.f,D.a*xA+D.c*yA+D.e,D.b*xA+D.d*yA+D.f);break;case "c":v.closePath();break;case "s":v.stroke();break;case "f":v.fill()}}}else sc(f,h,t.data,n-1,u-10*m[a].cxCharLeft,p-10*m[a].cyCharTop,
x,C,w,y)}else{v=t.getAttribute("data-cyframe");n=t.getAttribute("data-n");u=t.getAttribute("data-x");p=t.getAttribute("data-y");f.drawImage(t,0,(n-1)*v,t.width,v,u-m[a].cxCharLeft,p-m[a].cyCharTop,t.width,v);for(v=1;3>=v;v++)h=t.getAttribute("data-exclude"+v),""!=h&&(h=h.split(","),f.clearRect(h[0]-m[a].cxCharLeft,h[1]-m[a].cyCharTop,h[2],h[3]));ba&&Aa(d)}else Q("code 5")}cb(a)}}function sc(a,e,d,f,k,h,l,m,u,n){if(f>=d.frames.length)Q("Frame out of bounds "+e+" "+f);else{a.fillStyle="rgba(0,0,0,100)";
a.strokeStyle="rgba(0,0,0,100)";a.lineWidth=1.2;var p=e=0,q=0,v=0,w=0,y=0;f=d.frames[f];k=rc(l,k/10-d.xView/10*l,h/10-d.yView/10*l,m,u,n);for(h=0;h<f.length;h++)switch(d=f[h],d[0]){case "lw":a.lineWidth=1.2*d[1]/10*l;break;case "fs":a.fillStyle="rgba("+d[1]+","+d[2]+","+d[3]+","+d[4]/100+")";break;case "ss":a.strokeStyle="rgba("+d[1]+","+d[2]+","+d[3]+","+d[4]/100+")";break;case "bp":a.beginPath();v=q=y=w=0;break;case "m":w=d[1];y=d[2];a.moveTo(k.a*w+k.c*y+k.e,k.b*w+k.d*y+k.f);break;case "l":w=d[1];
y=d[2];a.lineTo(k.a*w+k.c*y+k.e,k.b*w+k.d*y+k.f);break;case "b":7==d.length?(e=d[1],p=d[2],q=d[3],v=d[4],w=d[5],y=d[6]):(e=w-(q-w),p=y-(v-y),q=d[1],v=d[2],w=d[3],y=d[4]);a.bezierCurveTo(k.a*e+k.c*p+k.e,k.b*e+k.d*p+k.f,k.a*q+k.c*v+k.e,k.b*q+k.d*v+k.f,k.a*w+k.c*y+k.e,k.b*w+k.d*y+k.f);break;case "c":a.closePath();break;case "s":a.stroke();break;case "f":a.fill()}}}function rc(a,e,d,f,k,h){var l={a:1,b:0,c:0,d:1};l.e=e;l.f=d;l.a=l.a/10*a;l.d=l.d/10*a;if(0!=h){l.e+=-(f/10+e);l.f+=-(k/10+d);a=Math.cos(-h/
10*3.1415926535/180);var m=Math.sin(-h/10*3.1415926535/180),u=-Math.sin(-h/10*3.1415926535/180);h=Math.cos(-h/10*3.1415926535/180);l.a=a*l.a+u*l.b;l.c=a*l.c+u*l.d;l.e=a*l.e+u*l.f;l.b=m*l.a+h*l.b;l.d=m*l.c+h*l.d;l.f=m*l.e+h*l.f;l.e+=f/10+e;l.f+=k/10+d}return l}function Ib(a){a=Math.floor(1E3*(a-1)/x.fps);la=a-1;ma=a;pa=na=(new Date).getTime();Jb=!0}function Da(a,e){1==e||3==e?c.add(a,1):2==e?c.add(a,2):c.rem(a)}function Ic(){var a=m[v],e=q[v],d=Kb-parseInt(e.left)-a.xBtwEye,e=Lb-parseInt(e.top)-a.yBtwEye;
d!=a.xMouseLast||e!=a.yMouseLast?(a.nInactive=0,a.fakingmouse=!1):(a.nInactive++,"user"==a.state&&45<a.nInactive&&.02>Math.random()&&(a.fakingmouse=!0,a.xMouseFake=200*Math.random()-100,-50<a.xMouseFake&&0>=a.xMouseFake&&(a.xMouseFake=-50),0<a.xMouseFake&&50>a.xMouseFake&&(a.xMouseFake=50),a.yMouseFake=200*Math.random()-100,-50<a.yMouseFake&&0>=a.xMouseFake&&(a.xMouseFake=-50),0<a.yMouseFake&&50>a.xMouseFake&&(a.xMouseFake=50),a.nInactive=0));a.xMouseLast=d;a.yMouseLast=e;a.fakingmouse&&(d=a.xMouseFake,
e=a.yMouseFake);a.nLastBlink++;a.nLastRandom++;if(a.stopping)a.xTrg=0,a.yTrg=0,a.nTrg=0;else if("eyetrack"!=a.state&&0==a.nInactive&&"eyetracker"==a.action)a.state="eyetrack",a.nTrg=0,a.nCur=0,a.xTrg=Math.round(d/10),a.yTrg=Math.round(e/20);else if("eyetrack"==a.state&&40>a.nInactive){if(d=Math.round(d/10),e=Math.round(e/20),d!=a.xTrg||e!=a.yTrg)a.xTrg=d,a.yTrg=e}else"eyetrack"==a.state&&40<=a.nInactive?(a.state="eyetrackstop",a.xTrg=0,a.yTrg=0):"randomheadattarget"==a.state&&(60<a.nLastBlink?(a.state=
"blink",a.nFrameBlink=1,a.nLastBlink=0):.03>Math.random()&&20<a.nLastRandom&&(a.nTrg=Mb(),a.nTrg!=a.nCur&&(a.state="randomheadmove",a.cFollow=0)));"user"==a.state&&(60<a.nLastBlink?(a.state="blink",a.nFrameBlink=1,a.nLastBlink=0):("eyetracker"==a.action||"lookuseridle"==a.action)&&.03>Math.random()&&20<a.nLastRandom&&(a.nTrg=Mb(),a.cFollow=0,a.state="randomheadmove"));if(a.xCur!=a.xTrg||a.yCur!=a.yTrg){d=Math.sqrt((a.xTrg-a.xCur)*(a.xTrg-a.xCur)+(a.yTrg-a.yCur)*(a.yTrg-a.yCur));e=.4*d;1>e&&(e=d);
var f=2;if("eyetrackstop"==a.state||a.fakingmouse)f=.5;a.xCur=0==d?a.xCur:Math.round(a.xCur+Math.min(f,e/d*(a.xTrg-a.xCur)));a.yCur=0==d?a.yCur:Math.round(a.yCur+Math.min(f,e/d*(a.yTrg-a.yCur)));d=a.xCur;e=a.yCur;f=m[v];c.rem(f.idBlink);c.rem(f.idBlink1);c.rem(f.idBlink2);c.rem(f.idBlink3);c.rem(f.idBlink4);c.rem(f.idBlink5);c.rem(f.idRandomLeft);c.rem(f.idRandomRight);-8>d&&(d=-8);8<d&&(d=8);-3>e&&(e=-3);3<e&&(e=3);0==d?(c.rem(f.idHeadRight),c.rem(f.idHeadLeft),c.add(f.idLookUser,1)):0<d?(c.rem(f.idLookUser),
c.rem(f.idHeadRight),c.add(f.idHeadLeft,d)):0>d&&(c.rem(f.idLookUser),c.rem(f.idHeadLeft),c.add(f.idHeadRight,-d));c.rem(f.idPupils0);c.rem(f.idPupils1);c.rem(f.idPupils2);c.rem(f.idPupils3);-3==e?c.add(f.idPupils3,d+9):-2==e?c.add(f.idPupils2,d+9):-1==e?c.add(f.idPupils1,d+9):0==e?c.add(f.idPupils0,d+9):1==e?c.add(f.idPupils1,17+d+9):2==e?c.add(f.idPupils2,17+d+9):3==e&&c.add(f.idPupils3,17+d+9)}if(a.nCur!=a.nTrg){a:{for(var d=a.nCur,e=[[5,4,3,2,1,0],[6,7,8,9,0],[104,103,102,101,0],[18,22,21,20,
19,0],[113,120,119,118,117,0],[0,1,2,3,4,5],[6,12,11,10,5],[104,107,106,105,5],[18,17,16,15,14,6,12,11,10,5],[113,112,111,110,109,108,104,107,106,106,5],[0,9,8,7,6],[5,10,11,12,6],[104,103,102,101,9,8,7,6],[18,17,16,15,14,13,6],[113,116,115,114,18,17,16,15,14,13,6],[0,101,102,103,104],[5,105,106,107,104],[6,7,8,9,101,102,103,104],[18,114,115,116,113,112,111,110,109,108,104],[113,112,111,110,109,108,104],[0,19,20,21,22,18],[5,4,3,2,1,0,19,20,21,22,18],[6,13,14,15,16,17,18],[104,108,109,110,111,112,
113,116,115,114,18],[113,116,115,114,18],[0,117,118,119,120,113],[5,4,3,2,1,0,117,118,119,120,113],[6,13,14,15,16,17,18,114,115,116,113],[104,108,109,110,111,112,113],[18,114,115,116,113]],k,h,f=0;f<e.length;f++)if(k=e[f].length,e[f][k-1]==a.nTrg)for(h=0;h<k-1;h++)if(e[f][h]==d){d=e[f][h+1];break a}for(f=0;f<e.length;f++)for(k=e[f].length,h=0;h<k-1;h++)if(e[f][h]==d){d=e[f][h+1];break a}}a.nCur=d;d=a.nCur;e=m[v];c.rem(e.idBlink);c.rem(e.idBlink1);c.rem(e.idBlink2);c.rem(e.idBlink3);c.rem(e.idBlink4);
c.rem(e.idBlink5);c.rem(e.idHeadLeft);c.rem(e.idHeadRight);c.rem(e.idPupils0);c.rem(e.idPupils1);c.rem(e.idPupils2);c.rem(e.idPupils3);0==d?(c.rem(e.idRandomLeft),c.rem(e.idRandomRight),c.add(e.idLookUser,1)):100<d?(c.rem(e.idLookUser),c.rem(e.idRandomRight),c.add(e.idRandomLeft,d-100)):(c.rem(e.idLookUser),c.add(e.idRandomRight,d),c.rem(e.idRandomLeft));a.nLastRandom=0}0<a.nFrameBlink&&(d=a.nFrameBlink,e=m[v],0==e.nCur?Da(e.idBlink,d):5==e.nCur?Da(e.idBlink1,d):6==e.nCur?Da(e.idBlink2,d):104==e.nCur?
Da(e.idBlink3,d):18==e.nCur?Da(e.idBlink4,d):113==e.nCur&&Da(e.idBlink5,d),a.nFrameBlink++,5==a.nFrameBlink&&(a.state="user",a.nFrameBlink=0));a.idMsgNext&&(a.stopping=!0);a.stopping&&0==a.xCur&&0==a.yCur&&0==a.nCur&&0==a.nFrameBlink?(a.stopped=!0,a.stopping=!1,a.action="",a.fStopReached&&(a.complete=!0,Pa(v))):"eyetrackstop"==a.state&&0==a.xCur&&0==a.yCur?a.state="user":"randomheadstop"==a.state&&0==a.nCur?a.state="user":"randomheadmove"==a.state&&a.nCur==a.nTrg&&(a.state="randomheadattarget",.7>
Math.random()&&3>a.cFollow&&(a.nTrg=Mb(),a.nTrg!=a.nCur&&(a.state="randomheadmove",a.cFollow++)))}function Mb(){var a;a=m[v].idRandomLeft?[5,6,104,18,113]:[5,6,18];return a[Math.floor(Math.random()*a.length)]}function Tb(){if(!(h.Paused||ja||W||da||I)&&0==Za()&&null==va){var a=(new Date).getTime();a>pa+1E3/x.fps&&(pa=a,gc(a-na+ma))}h.vh&&(a=h.vh.cp.variablesManager.getVariableValue("msPlay"))&&(h.msPlay(a),h.vh.cp.variablesManager.setVariableValue("msPlay",""));try{if(parent.GetPlayer){var e=parent.GetPlayer().GetVar("msPlay");
e&&(h.msPlay(e),parent.GetPlayer().SetVar("msPlay",""))}}catch(d){}requestAnimationFrame(Tb)}function gc(a){if(!Nb){Nb=!0;var e=la,d;for(d in m)if(m[d].idScene==B&&!(I&&I!=d||m[d].complete)){var f=q[m[d].idMsg];if(f&&(f.external&&wa&&(f=wa),f&&f.onframe)){for(var k in f.onframe)if(0!=k){if(Jb){Jb=!1;break}var l=Math.floor(1E3*(k-1)/x.fps);l>la&&l<=a&&(m[d].fFirstFrameAfterRec&&(m[d].aImgShow=[],m[d].fFirstFrameAfterRec=!1),m[d].started=!0,cb(d),v=d,O=m[d].idMsg,c=h,eval(f.onframe[k]),O=v=c=null,aa&&
!I&&Hb(d,f.id))}""==m[d].action||I||(cb(d),v=d,O=m[d].idMsg,c=h,Ic(),O=v=c=null,aa&&Hb(d,f.id));m[d].charCanvas&&!I&&jc(d)}if(W||da||I)break}la==e&&(la=Math.max(la,a));Nb=!1}}function tc(a){if(a=q[a]){a.toggleschosen&&(a.chosen=!a.chosen,ea(a.id));a.stayschosen&&(a.chosen=!0,ea(a.id));if(a.resetspeers)for(var e in a.parent.items){var d=a.parent.items[e];"button"==d.type&&d!=a&&(d.chosen=!1,ea(d.id))}if(e=a.onclick)c=h,eval(e),c=null}}function uc(a){for(var e in a.items){var d=a.items[e];"button"==
d.type?"enter"==d.key&&tc(d.id):"slideshow"!=d.type&&"slide"!=d.type&&"grid"!=d.type||uc(d)}}function Ob(){"function"==typeof onVariableChange&&onVariableChange(l)}function yb(){A("Firing onQueueLengthChange("+l+","+X.length+")");"function"==typeof onQueueLengthChange&&onQueueLengthChange(l,X.length)}function Jc(a){if("Stop"!=ia)for(;;){var e=a[ia];if(!e){Q("missing state "+ia);break}for(var d=[],f=0;f<e.transitions.length;f++){var k=e.transitions[f];if(k[0].toLowerCase()==sa.toLowerCase()||"*"==
k[0]){var l=!0;k[1]&&(c=h,l=eval(k[1]),c=null);if(l){d.push(f);break}}}if(0==d.length){""!=sa&&A("No transition possible for input: "+sa);break}else if(A("Taking transition "+(d[0]+1)),k=e.transitions[d[0]],e=k[2],c=h,eval(e),c=null,ia=k[3],sa="",-1!=e.indexOf("msSetVariable")&&Ob(),A("New state: "+ia),"Stop"==ia)break;else if(e=a[ia],e=e.actions)c=h,eval(e),c=null,-1!=e.indexOf("msSetVariable")&&Ob()}}function lb(a,e){var d=document.createElement(a||"div"),f;for(f in e)d[f]=e[f];return d}function mb(a){for(var e=
1,d=arguments.length;e<d;e++)a.appendChild(arguments[e]);return a}function Kc(a,e,d,f){var k=["opacity",e,~~(100*a),d,f].join("-");d=.01+d/f*100;f=Math.max(1-(1-a)/e*(100-d),a);var h=nb.substring(0,nb.indexOf("Animation")).toLowerCase();vc[k]||(Lc.insertRule("@"+(h&&"-"+h+"-"||"")+"keyframes "+k+"{0%{opacity:"+f+"}"+d+"%{opacity:"+a+"}"+(d+.01)+"%{opacity:1}"+(d+e)%100+"%{opacity:"+a+"}100%{opacity:"+f+"}}",0),vc[k]=1);return k}function La(a,e){for(var d in e){var f=a.style,k;a:{k=d;var h=a.style,
l=void 0,m=void 0;if(void 0===h[k]){k=k.charAt(0).toUpperCase()+k.slice(1);for(m=0;m<wc.length;m++)if(l=wc[m]+k,void 0!==h[l]){k=l;break a}k=void 0}}f[k||d]=e[d]}return a}function xc(a){for(var e=1;e<arguments.length;e++){var d=arguments[e],f;for(f in d)void 0===a[f]&&(a[f]=d[f])}return a}function yc(a){for(var e={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)e.x+=a.offsetLeft,e.y+=a.offsetTop;return e}var h=null,x=void 0,q=null;this.Presenting=!1;this.Text=this.Focus="";this.Muted=this.Paused=
!1;traceLevel=2;var ja=!1,zc=!1,Ac="complete"===document.readyState,ob=!1,B=null,fb=null,G=null,za=null,M=null,Ga=null,ya=null,U=null,Ha=null,ga=null,W=null,da=null,I=null,Va=null,Na=!1,Eb=!1,E=0,H={},m={},ka=[],v,O,ab=0,aa,Ca,Ba,jb,kb,la=-1,ma=0,na=0,pa=0,Jb=!1,va=null,Wa=null,wa=null,Ya=null,ia,sa,X=[],Bc=!1,Pb=null,Ja="",Ua=null,Yb=(new Date).getTime(),Cc=0,fa=[],db=!1,ha=1,Qb=0,Rb=0,ta=[],Kb=0,Lb=0,Ia=navigator.userAgent.match(/iPhone/i),hb=navigator.userAgent.match(/iPad/i),ba=navigator.userAgent.match(/android/i);
navigator.userAgent.match(/AppleWebKit/i);this.realizeTopLevel=function(a){a&&document.write('<div id="'+l+'" style="top:0px; left:0px; width:'+z+"px; height:"+F+'px"></div>');a=document.getElementById(l);s="";s+='<div id="'+l+'Stage" style="position:relative" width="'+z+'" height="'+F+'" onkeydown="msEvent('+("'"+l+"','"+l+"Stage','keydown'")+')">';s+="&nbsp;";s+="</div>";a.innerHTML=s;if(!DetectHTML5())return a;qb=(new pb({lines:11,length:7,width:4,radius:10,rotate:0,color:"#eeeeee",speed:1,trail:60,
shadow:!1,hwaccel:!1,className:"spinner",zIndex:1,top:F/2-17,left:z/2-17})).spin(a);var e=document.createElement("script");a.appendChild(e);var d=V(p+".js");"true"==h.Preview&&(d+="?Preview=true");e.src=d;return a};var qb=null,Ma=!0;this.setCtl=function(a){h=a};this.aDocLoaded=function(){if(void 0==x){if(x=window[p+"_Dir"],void 0!=x)if("true"==x.exceeded||"true"==x.trial&&x.hostingresources&&""!=x.hostingresources)document.getElementById(l+"Stage").innerHTML='<div style="position:absolute; left:'+
(z-112)/2+"px; top:"+(F-112)/2+'px; width:112px; height:87px;"/><a href="http://www.mediasemantics.com"><img src="http://www.characterhosting.com/images/MSLogo.gif" border="0"></a></div>',R();else{q={};x.type="project";x.parent=null;Xb(x,"");parseInt(x.version.split(".")[3])&1&&(Bc=!0);s="";for(var a in x.items)s+='<div id="'+l+a+'Div" style="display:none; left:0px; top:0px; position:absolute" width="'+z+'" height="'+F+'">',s+='<div id="'+l+a+'Inner" style="left:0px; top:0px; position:relative" width="'+
z+'" height="'+F+'">',s+=rb(x.items[a]),Bc&&(s+='<canvas id="BubbleLayer" style="position:absolute; left:0px; top:0px;" width="'+z+'" height="'+F+'"/></canvas>'),"always"!=x.allowautoplay&&("never"==x.allowautoplay||(Ia||hb||ba)&&1==x.presenting&&!x.noaudio)&&(A("allowautoplay - initially presenting, have audio: putting up StartShield, Presenting now false"),s+='<canvas id="'+l+'StartShield" style="position:absolute; z-index:1000; left:0px; top:0px;" width="'+z+'" height="'+F+'" onclick="msEvent('+
("'"+l+"',null,'shieldclick'")+')"/></canvas>',ja=!0,h.Presenting=!1),s+="</div>",s+="</div>",s+='<div id="'+l+'Measure" style="position:absolute; visibility:hidden; width:auto; height:auto"></div>';"true"==h.Preview&&(s+='<div id="'+l+'PreviewDiv" style="display:none; position:absolute; left:'+(z-120)/2+"px; top:"+(F-120)/2+'px; width:120px; height:120px;"/><img src="http://www.characterhosting.com/images/MSPreview.png" border="0"></div>');document.getElementById(l+"Stage").innerHTML=s;for(var e in x.items)nc(x.items[e]);
if(a=document.getElementById("BubbleLayer")){a=a.getContext("2d");var d=e=0;for(e=0;e<10*z;e+=875)for(d=0;d<10*F;d+=875)Pb||(Pb={msvector:!0,data:{cx:"6120",cy:"7920",xView:"990",yView:"820",cxView:"1750",cyView:"1750",frames:[[["fs",35,31,32,50],["bp"],["m",1391,978],["l",1478,1065],["l",1438,1105],["l",1403,1070],["l",1365,1108],["l",1398,1141],["l",1360,1179],["l",1327,1146],["l",1283,1190],["l",1321,1228],["l",1281,1268],["l",1190,1177],["l",1391,978],["c"],["f"],["bp"],["m",1621,1208],["l",1393,
1383],["l",1314,1304],["l",1485,1073],["l",1540,1128],["b",1491,1190,1449,1241,1413,1282],["b",1454,1246,1492,1214,1525,1187],["l",1566,1153],["l",1621,1208],["c"],["f"],["bp"],["m",1717,1304],["l",1546,1535],["l",1493,1482],["l",1526,1443],["l",1507,1424],["l",1468,1457],["l",1414,1403],["l",1642,1228],["l",1717,1304],["c"],["m",1560,1406],["b",1580,1381,1606,1350,1637,1314],["b",1593,1347,1562,1372,1542,1388],["l",1560,1406],["c"],["f"],["bp"],["m",1808,1395],["l",1647,1556],["l",1679,1588],["l",
1639,1628],["l",1555,1544],["l",1756,1343],["l",1808,1395],["c"],["f"],["bp"],["m",1971,1559],["l",1837,1693],["b",1822,1708,1811,1718,1803,1724],["b",1796,1729,1787,1733,1775,1734],["b",1764,1736,1752,1734,1741,1729],["b",1719,1717,1708,1706],["b",1696,1694,1687,1681,1682,1668],["b",1677,1655,1675,1643,1677,1632],["b",1679,1621,1683,1612,1689,1604],["b",1710,1581,1732,1558],["l",1851,1439],["l",1903,1491],["l",1753,1642],["b",1744,1651,1739,1657,1738,1660],["b",1737,1663,1737,1667,1740,1669],["b",
1743,1672,1747,1673,1750,1671],["b",1754,1669,1760,1663,1771,1653],["l",1919,1505],["l",1971,1559],["c"],["f"],["bp"],["m",2082,1670],["l",1911,1901],["l",1858,1848],["l",1891,1809],["l",1872,1790],["l",1833,1823],["l",1779,1769],["l",2007,1594],["l",2082,1670],["c"],["m",1925,1771],["b",1945,1746,1971,1715,2002,1679],["b",1958,1712,1927,1737,1907,1753],["l",1925,1771],["c"],["f"],["bp"],["m",2212,1800],["l",2172,1840],["l",2141,1809],["l",1980,1970],["l",1928,1918],["l",2089,1757],["l",2058,1726],
["l",2098,1686],["l",2212,1800],["c"],["f"],["bp"],["m",2276,1864],["l",2075,2065],["l",2023,2013],["l",2224,1812],["l",2276,1864],["c"],["f"],["bp"],["m",2299,2122],["b",2279,2142,2264,2156,2255,2164],["b",2235,2176,2223,2178],["b",2211,2180,2199,2179,2187,2174],["b",2175,2169,2163,2161,2152,2150],["b",2141,2139,2133,2128,2128,2116],["b",2121,2092,2123,2079],["b",2125,2067,2129,2056,2137,2047],["b",2144,2038,2158,2023,2179,2002],["l",2213,1968],["b",2233,1948,2248,1934,2257,1926],["b",2266,1919,
2277,1914,2289,1912],["b",2301,1910,2313,1911,2325,1916],["b",2337,1921,2349,1929,2360,1940],["b",2371,1951,2379,1962,2384,1974],["b",2389,1986,2391,1998,2389,2011],["b",2387,2023,2383,2034,2375,2043],["b",2368,2052,2354,2067,2333,2088],["l",2299,2122],["c"],["m",2313,2004],["b",2322,1995,2328,1988,2329,1984],["b",2331,1980,2330,1977,2327,1974],["b",2324,1971,2321,1970,2318,1971],["b",2307,1977,2297,1988],["l",2203,2082],["b",2191,2094,2185,2101,2183,2105],["b",2181,2109,2182,2112,2186,2116],["b",
2190,2120,2193,2120,2198,2118],["b",2202,2116,2210,2109,2222,2097],["l",2313,2004],["c"],["f"],["bp"],["m",2553,2141],["l",2352,2342],["l",2306,2296],["l",2370,2177],["l",2279,2268],["l",2235,2224],["l",2436,2023],["l",2480,2067],["l",2419,2187],["l",2510,2096],["l",2553,2141],["c"],["f"]]]}}),sc(a,"",Pb.data,0,e,d,.5,0,0,0)}if(a=document.getElementById(l+"StartShield"))a=a.getContext("2d"),a.fillStyle="#000000",a.globalAlpha=.5,a.fillRect(0,0,z,F),e=z/2,d=F/2,a.beginPath(),a.arc(e,d,25,0,2*Math.PI,
!1),a.fillStyle="#999999",a.globalAlpha=.5,a.fill(),a.beginPath(),a.arc(e,d,27,0,2*Math.PI,!1),a.strokeStyle="#cccccc",a.lineWidth=5,a.globalAlpha=1,a.stroke(),a.beginPath(),e-=12,d-=15,a.moveTo(e,d),d+=30,a.lineTo(e,d),d-=15,e+=30,a.lineTo(e,d),a.lineTo(e-30,d-15),a.fillStyle="#cccccc",a.globalAlpha=1,a.fill();zc=!0;Ac&&!ob&&(ob=!0,Sb())}}else Va&&(a=Va,Va=null,Ab(idChar,a))};(function(){for(var a=0,e=["ms","moz","webkit","o"],d=0;d<e.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=
window[e[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[d]+"CancelAnimationFrame"]||window[e[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(d,e){var h=(new Date).getTime(),l=Math.max(0,16-(h-a)),m=window.setTimeout(function(){d(h+l)},l);a=h+l;return m});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();this.aVectorLoaded=function(){nAudio=Za();for(var a in H){var e=H[a];T(e)&&null==
e.data&&(e.data=window["MS"+e.digest],e.data&&E--)}W&&0==E?Cb():da&&0==E?Db():I&&0==E&&Xa()};var qa=[];this.startPresenting=function(){A("startPresenting");h.Presenting||(q[h.Focus]?(h.Presenting=!0,h.Paused=!1,K()):Q("startPresenting() - no valid messages available"))};this.restartPresenting=function(){A("restartPresenting");q[h.Focus]?(h.Presenting=!0,h.Paused=!1,K()):Q("restartPresenting() - no valid messages available")};this.stopPresenting=function(){A("stopPresenting");h.Presenting&&(h.Presenting=
!1,h.Paused=!1,K())};this.pausePresenting=function(){A("pausePresenting");if(!h.Paused){Cc=(new Date).getTime()-na+ma;for(charid in m)if(m[idChar].idScene==B){var a=document.getElementById(l+idChar+"Audio");a&&Fa(a)}h.Paused=!0;Z(x)}};this.resumePresenting=function(){A("resumePresenting");if(h.Paused){for(charid in m)if(m[idChar].idScene==B){var a=document.getElementById(l+idChar+"Audio");a&&hc(a)}h.Paused=!1;Z(x);ma=Cc;pa=na=(new Date).getTime()}};this.msgoto=function(a){A("goto "+a);a=P(a);h.Focus=
a;h.Paused=!1;K()};this.gotoAndRestart=function(a){A("gotoAndRestart "+a);a=P(a);h.Focus=a;h.Presenting=!0;h.Restart=!0;h.Paused=!1;K()};this.externalCommand=function(a,e){A("Firing onExternalCommand("+a+","+e+")");"function"==typeof onExternalCommand&&onExternalCommand(l,a,e);h.vh&&h.vh.cp.variablesManager.setVariableValue(a,e)};this.bubble=function(a,e){A("bubble "+a+" "+e);var d;a:{d=ub("scene",q[a]);for(var f in d.items){var k=d.items[f];if("bubble"==k.type&&(!k.target||k.target==a)){d=k;break a}}d=
null}d&&(Ja="",oc(d,e))};this.nextFocus=function(){A("nextFocus");var a=lc();a?h.Focus=a:h.Presenting=!1;"always"!=x.allowautoplay&&("never"==x.allowautoplay||(Ia||hb||ba)&&1==x.presenting&&!x.noaudio&&fInTimeline)&&(A("allowautoplay - presenting, encountered next: going Presenting false"),h.Presenting=!1);K();h.Paused=!1};this.previousFocus=function(){A("previousFocus");var a=mc();a&&(h.Focus=a,K());h.Paused=!1};this.firstFocus=function(){A("firstFocus");var a;a=null;x.focusisland?null!=fb?a=Y("slide",
q[fb]):null!=za&&(a=Y("step",q[za])):a=Y("scene",x);a&&(h.Focus=a,K());h.Paused=!1};this.mute=function(){A("mute");h.Muted=!0;Z(x);pc()};this.unmute=function(){A("unmute");h.Muted=!1;Z(x);pc()};this.trace=function(a){console.log(a)};this.getText=function(a){return(a=document.getElementById(l+a+"Edit"))?a.value:""};this.setText=function(a,e){var d=document.getElementById(l+a+"Edit");d&&(d.value=e)};this.daysSinceLastVisit=function(){var a=(new Date).getTime(),e=parseInt($b("lastvisit"));ac("lastvisit",
a.toString(),365);return ret=e?Math.floor((a-e)/864E5):a+31536E6};this.android=function(){return ba};this.iOS=function(){return Ia||hb};this.firstFAQ=function(){return ib(1)};this.nextFAQ=function(){return ib(2)};this.previousFAQ=function(){return ib(3)};this.targetFAQ=function(){return ib(4)};this.show=function(a){a=P(a);if(a=ca(a))a.style.display="block"};this.hide=function(a){a=P(a);if(a=ca(a))a.style.display="none"};this.fadein=function(a){a=P(a);(a=ca(a))&&kc(a,500)};this.fadeout=function(a){a=
P(a);if(a=ca(a))fade={from:a,to:null,cms:500,tStart:(new Date).getTime()},fa.push(fade),db||eb()};this.setPosition=function(a,e,d){e=Math.round(e);d=Math.round(d);a=P(a);var f=q[a];f&&(f.left=e,f.top=d);if(a=ca(a))a.style.left=e+"px",a.style.top=d+"px"};this.setSize=function(a,e,d){e=Math.round(e);d=Math.round(d);a=P(a);var f=q[a];f&&(f.width=e,f.height=d);var k=ca(a);k&&f&&("character"==f.type?(e=m[f.id].idMsg,d=Ub(f.id,f),k.outerHTML=d,m[f.id].idMsg=e):"bubble"==f.type?(d=Vb(f.id,f),k.outerHTML=
d):(k.style.width=e+"px",k.style.height=d+"px","image"==f.type?k.style.backgroundSize=e+"px "+d+"px":"movie"==f.type&&(f=Ka(a),f.width=e,f.height=d)))};this.getX=function(a){return(a=ca(P(a)))?parseInt(a.style.left.replace("px","")):0};this.getY=function(a){return(a=ca(P(a)))?parseInt(a.style.top.replace("px","")):0};this.getWidth=function(a){return(a=ca(P(a)))?parseInt(a.style.width.replace("px","")):0};this.getHeight=function(a){return(a=ca(P(a)))?parseInt(a.style.height.replace("px","")):0};this.stageWidth=
function(){return z};this.stageHeight=function(){return F};this.max=function(a,e){return a>=e?a:e};this.min=function(a,e){return a>=e?e:a};this.moviePlay=function(a){(a=Ka(a))&&a.play()};this.movieStop=function(a){(a=Ka(a))&&a.pause()};this.movieReached=function(a,e){var d=Ka(a);return d?d.currentTime>=e:!1};this.movieReachedEnd=function(a){return(a=Ka(a))?a.currentTime>=a.duration:!1};this.setFocus=function(a){};this.random=function(){ta.push(Math.random()*ta.pop())};this.push=function(a){ta.push(a)};
this.lessthan=function(){var a=ta.pop(),e=ta.pop();ta.push(e<a)};this.ifnot=function(a){ta.pop()||Ib(a)};this.branch=function(a){Ib(a)};this.button=function(a){for(var e=dc(v),d=0;d<e.abtn.length;d++)if(a==e.abtn[d].text){document.getElementById(l+e.id+"Btn"+d+"Up").style.display="block";document.getElementById(l+e.id+"Btn"+d+"Lbl").style.display="block";break}};this.load=function(a,e,d,f,k,h){0!=ab&&h>ab||(a=O+a,d=Ya?Fc(Ya,e):V(e),".js"==e.substr(e.length-3)?(H[a]={},H[a].msvector=!0,H[a].digest=
e.substr(0,e.length-3),window["MS"+H[a].digest]?H[a].data=window["MS"+H[a].digest]:(H[a].data=null,a=document.createElement("script"),document.getElementById(l).appendChild(a),E++,a.src=d)):(e=bc(d),H[a]=Fb(e),H[a].src!=e&&(H[a].onload=function(){Bb()},H[a].setAttribute("data-cyframe",k),E++,H[a].src=d)))};this.update=this.add=function(a,e,d,f,k,h,t){var n=0,u=0,p=1,x=0,A=0,C=0,w=m[v].aImg[O+a];if(null!=w){m[v].lastCmdAddId=a;qc(v,O+a);7<=arguments.length?(n=e,u=d,p=f,x=k,A=h,C=t):4==arguments.length?
(n=e,u=d,p=f,x=T(w)?w.rx:parseInt(w.getAttribute("data-rx")),A=T(w)?w.ry:parseInt(w.getAttribute("data-ry")),C=T(w)?w.rn:parseInt(w.getAttribute("data-rn"))):2==arguments.length&&(p=e,n=T(w)?w.x:parseInt(w.getAttribute("data-x")),u=T(w)?w.y:parseInt(w.getAttribute("data-y")),x=T(w)?w.rx:parseInt(w.getAttribute("data-rx")),A=T(w)?w.ry:parseInt(w.getAttribute("data-ry")),C=T(w)?w.rn:parseInt(w.getAttribute("data-rn")));"infront"==q[v].mode&&(aa=!0);var y;aa||(y=parseInt(w.getAttribute("data-cyframe")),
n>=Ca&&n<=Ca+jb&&n+w.width>=Ca&&n+w.width<=Ca+jb&&u>=Ba&&u<=Ba+kb&&u+y>=Ba&&u+y<=Ba+kb||(aa=!0));if(!aa){var D=m[v].charCanvas?m[v].charCanvas:document.getElementById(l+v+"Canvas");if(D.getContext){var B=D.getContext("2d");B.clearRect(n-m[v].cxCharLeft,u-m[v].cyCharTop,w.width,y);ba&&Aa(D);B.drawImage(w,0,(p-1)*y,w.width,y,n-m[v].cxCharLeft,u-m[v].cyCharTop,w.width,y);for(var z=7;arguments.length>z;)B.clearRect(arguments[z]-m[v].cxCharLeft,arguments[z+1]-m[v].cyCharTop,arguments[z+2],arguments[z+
3]),z+=4;ba&&Aa(D)}else Q("No canvas support.");Ca=n;Ba=u;jb=w.width;kb=y}if(T(w))w.x=n,w.y=u,w.n=p,w.rx=x,w.ry=A,w.rn=C,w.morph=null;else for(w.setAttribute("data-x",n),w.setAttribute("data-y",u),w.setAttribute("data-n",p),w.setAttribute("data-rx",x),w.setAttribute("data-ry",A),w.setAttribute("data-rn",C),z=7,n=1;3>=n;n++)u="",arguments.length>z&&(u=arguments[z]+","+arguments[z+1]+","+arguments[z+2]+","+arguments[z+3]),w.setAttribute("data-exclude"+n,u),z+=4}};this.updatetween=this.addtween=function(a,
e,d,f,h,l,n,p){var u=0,q=0,x=0,z=0,A=0,w=0,y=m[v].aImg[O+a],D=m[v].aImg[O+e];y&&D&&(qc(v,O+a),8<=arguments.length?(u=d,q=f,x=h,z=l,A=n,w=p):5<=arguments.length?(u=d,q=f,x=h):3==arguments.length&&(x=d,u=y.x,q=y.y),y.x=u,y.y=q,y.n=x,y.rx=z,y.ry=A,y.rn=w,y.morph=e,aa=!0)};this.rem=function(a){a:{a=O+a;for(var e=m[v].aImgShow,d=0;d<e.length;d++)if(e[d]==a){e.splice(d,1);break a}}aa=!0};this.stop=function(){var a=!1;q[O].idle&&null==m[v].idMsgNext&&(a=!0);if(a)la=-1,ma=0,pa=na=(new Date).getTime();else{a=
m[v];a.fRecovering=!1;a.fFirstFrameAfterRec=!1;a.fStopReached=!0;var e=document.getElementById(l+v+"Audio");Fa(e);a.action||(a.complete=!0,Pa(v))}};this.rec=function(a){m[v].idMsgNext&&(Ib(a),m[v].fRecovering=!0,m[v].fFirstFrameAfterRec=!0)};this.addctl=function(a,e,d,f){var h=m[v];h.idLookUser||(h.idLookUser=h.lastCmdAddId);"headright"==f?h.idHeadRight=a:"headleft"==f?h.idHeadLeft=a:"pupils0"==f?h.idPupils0=a:"pupils1"==f?h.idPupils1=a:"pupils2"==f?h.idPupils2=a:"pupils3"==f?h.idPupils3=a:"randomright"==
f?h.idRandomRight=a:"randomleft"==f?h.idRandomLeft=a:"random1blink"==f?h.idBlink1=a:"random2blink"==f?h.idBlink2=a:"random3blink"==f?h.idBlink3=a:"random4blink"==f?h.idBlink4=a:"random5blink"==f?h.idBlink5=a:"blink"==f&&(h.idBlink=a);if(a=h.aImg[O+a])a.setAttribute("data-x",e),a.setAttribute("data-y",d)};this.addtweenctl=function(){};this.ctlaction=function(a){var e=m[v];e.action=a;e.state="user";e.nLastBlink=0;e.nFrameBlink=0;e.stopping=!1;e.stopped=!1;e.xBtwEye=0;e.yBtwEye=0;e.nInactive=1E3;cFollow=
e.nLastRandom=0;e.fakingmouse=!1;e.xTrg=0;e.yTrg=0;e.nTrg=0;e.xCur=0;e.yCur=0;e.nCur=0;var d;e.idPupils0&&(d=e.aImg[O+e.idPupils0])&&(e.xBtwEye=parseInt(d.getAttribute("data-x"))+d.width/2,e.yBtwEye=parseInt(d.getAttribute("data-y"))+parseInt(d.getAttribute("data-cyframe"))/2);a=q[v];e.xMouseLast=Kb-parseInt(a.left)-e.xBtwEye;e.yMouseLast=Lb-parseInt(a.left)-e.yBtwEye};this.onPageLoad=function(){Ac=!0;zc&&!ob&&(ob=!0,Sb())};this.onMouseMove=function(a){a=a||window.event;var e=document.getElementById(l).getBoundingClientRect();
Kb=a.clientX+Rb-e.left;Lb=a.clientY+Qb-e.top};this.onScroll=function(){Qb=document.body.scrollTop;Rb=document.body.scrollLeft};var Nb=!1;this.msEvent=function(a,e,d){switch(e){case "audioonloadstart":break;case "audioonprogress":break;case "audiooncanplaythrough":e=document.getElementById(l+a+"Audio");Fa(e);m[a].loadingAudio&&fc(a);break;case "audioonerror":e=document.getElementById(l+a+"Audio");m[a].loadingAudio&&(Q("Embedded character unable to play audio - will still move lips"+("object"==typeof e.error?
" - code "+e.error.code:"")),fc(a));break;case "audioonstalled":break;case "audioonloadedmetadata":break;case "audioonplaying":break;case "audioonended":break;case "audioontimeupdate":e=document.getElementById(l+a+"Audio");0<e.currentTime&&!m[a].fRecovering&&(ma=Math.floor(1E3*e.currentTime),na=(new Date).getTime());break;case "onload":onload(a);break;case "buttonclick":tc(a);break;case "mouseover":q[a].over=!0;ea(a);break;case "mouseout":q[a].over=!1;ea(a);break;case "mousedown":q[a].down=!0;ea(a);
break;case "mouseup":q[a].down=!1;ea(a);break;case "bsbuttonclick":Ec(a,d);break;case "bsmousedown":document.getElementById(l+a+"Btn"+d+"Up").style.display="none";document.getElementById(l+a+"Btn"+d+"Dn").style.display="block";break;case "bsmouseup":document.getElementById(l+a+"Btn"+d+"Up").style.display="block";document.getElementById(l+a+"Btn"+d+"Dn").style.display="none";break;case "editchange":e=q[a];e.variable&&(a=document.getElementById(l+a+"Edit"))&&h[e.variable]!=a.value&&(h[e.variable]=a.value,
Ob());break;case "editfocus":Ia&&window.scrollTo(Rb,Qb);break;case "keydown":13==event.keyCode&&uc(q[B]);break;case "shieldclick":A("user clicked StartShield");(a=document.getElementById(l+"StartShield"))&&a.parentNode.removeChild(a);ja=!1;h.startPresenting();Ra();break;default:Q("unhandled event "+e)}};this.msSetTraceLevel=function(a){traceLevel=a};this.msPlay=function(a){A("msPlay('"+a+"')");a=P(a);X=[];var e=h.Presenting;h.Presenting=!0;e!=h.Presenting&&(A("Firing onPresentingChange("+l+","+h.Presenting+
")"),"function"==typeof onPresentingChange&&onPresentingChange(l,h.Presenting));e=h.Focus;h.Focus=a;e!=h.Focus&&(A("Firing onFocusChange("+l+","+h.Focus+")"),"function"==typeof onFocusChange&&onFocusChange(l,h.Focus));0!=h.Presenting&&(q[h.Focus]?K():Q("msPlay() - unknown message "+a),ja&&(A("external api caused us to remove StartShield"),(a=document.getElementById(l+"StartShield"))&&a.parentNode.removeChild(a),ja=!1,Ra()))};this.msPlayQueued=function(a){A("msPlayQueued('"+a+"')");h.Presenting||h.Restart?
(X.push({type:"play",data:a}),yb()):(h.Focus=P(a),h.Presenting=!0,q[h.Focus]?K():Q("msPlayQueued() - no message "+a))};this.msSpeak=function(a){A("msSpeak('"+a+"')");X=[];h.Presenting=!0;h.Focus=P("Speak");h.Text=a;q[h.Focus]?K():Q("msSpeak() - no external message named Speak")};this.msSpeakQueued=function(a){A("msSpeakQueued('"+a+"')");h.Presenting||h.Restart?(X.push({type:"speak",data:a}),yb()):(h.Text=a,h.Focus=P("Speak"),h.Presenting=!0,q[h.Focus]?K():Q("msSpeakQueued() - no message named Speak"))};
this.msRespond=function(a){A("msRespond('"+a+"')");X=[];h.Presenting=!0;h.Focus=P("Respond");h.Text=a;q[h.Focus]?K():Q("msRespond() - no external message named Respond")};this.msStart=function(){A("msStart()");X=[];this.startPresenting()};this.msStop=function(){A("msStop()");X=[];this.stopPresenting()};this.msGetVariable=function(a){return this[a]};this.msSetVariable=function(a,e){this[a]=e};this.msGetVariables=function(){var a={};for(key in this)key.substr(0,1).toUpperCase()==key.substr(0,1)&&"Presenting"!=
key&&"Focus"!=key&&"Paused"!=key&&"Muted"!=key&&(a[key]=this[key]);return a};this.msSetVariables=function(a){for(key in a)this[key]=a[key]};this.msStartShieldUp=function(){return ja};this.msRunSequencer=function(a,e){e?(sa=e,A("Restarting machine with: "+sa)):(ia="Start",sa="Ok",A("Initial state: "+ia));Jc(a)};this.onLoad=function(){this.captivate&&(h.vh=this.captivate.CPMovieHandle.getMovieProps().variablesHandle)};var wc=["webkit","Moz","ms","O"],vc={},nb,Lc=function(){var a=lb("style");mb(document.getElementsByTagName("head")[0],
a);return a.sheet||a.styleSheet}(),Mc={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2E9,className:"spinner",top:"auto",left:"auto"},pb=function e(d){if(!this.spin)return new e(d);this.opts=xc(d||{},e.defaults,Mc)};pb.defaults={};xc(pb.prototype,{spin:function(e){this.stop();var d=this,f=d.opts,h=d.el=La(lb(0,{className:f.className}),{position:"relative",zIndex:f.zIndex}),l=f.radius+f.length+f.width,m,n;e&&(e.appendChild(h),n=yc(e),m=yc(h),La(h,
{left:("auto"==f.left?n.x-m.x+(e.offsetWidth>>1):f.left+l)+"px",top:("auto"==f.top?n.y-m.y+(e.offsetHeight>>1):f.top+l)+"px"}));h.setAttribute("aria-role","progressbar");d.lines(h,d.opts);if(!nb){var p=0,q=f.fps,v=q/f.speed,x=(1-f.opacity)/(v*f.trail/100),z=v/f.lines;!function y(){p++;for(var e=f.lines;e;e--){var l=Math.max(1-(p+e*z)%v*x,f.opacity);d.opacity(h,f.lines-e,l,f)}d.timeout=d.el&&setTimeout(y,~~(1E3/q))}()}return d},stop:function(){var e=this.el;e&&(clearTimeout(this.timeout),e.parentNode&&
e.parentNode.removeChild(e),this.el=void 0);return this},lines:function(e,d){function f(e,f){return La(lb(),{position:"absolute",width:d.length+d.width+"px",height:d.width+"px",background:e,boxShadow:f,transformOrigin:"left",transform:"rotate("+~~(360/d.lines*h+d.rotate)+"deg) translate("+d.radius+"px,0)",borderRadius:(d.width>>1)+"px"})}for(var h=0,l;h<d.lines;h++)l=La(lb(),{position:"absolute",top:1+~(d.width/2)+"px",transform:d.hwaccel?"translate3d(0,0,0)":"",opacity:d.opacity,animation:nb&&Kc(d.opacity,
d.trail,h,d.lines)+" "+1/d.speed+"s linear infinite"}),d.shadow&&mb(l,La(f("#000","0 0 4px #000"),{top:"2px"})),mb(e,mb(l,f(d.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,d,f){d<e.childNodes.length&&(e.childNodes[d].style.opacity=f)}});window.Spinner=pb}function DetectHTML5(){var l=document.createElement("audio")||!1,l=l&&"undefined"!==typeof l.canPlayType,p=document.createElement("canvas"),p=!(!p.getContext||!p.getContext("2d"));return l&&p}
function msGetFlash(l){return-1!=navigator.appName.indexOf("Microsoft")?window[l]:document[l]}function msIsFlash(l){return"[object HTMLEmbedElement]"==l.toString()||"[object HTMLObjectElement]"==l.toString()}function msIsHTML5(l){return"[object HTMLDivElement]"==l.toString()&&l.hasOwnProperty("ctl")}function msDocLoaded(){for(var l=0;l<msEmbeddings.length;l++)msEmbeddings[l].aDocLoaded()}function msVectorLoaded(){for(var l=0;l<msEmbeddings.length;l++)msEmbeddings[l].aVectorLoaded()}
function msEvent(l,p,n,z){document.getElementById(l).ctl.msEvent(p,n,z)}function msPlay(l,p){var n=document.getElementById(l);null==n&&(n=msGetFlash(l));msIsFlash(n)?n.msPlay(p):msIsHTML5(n)&&n.ctl.msPlay(p)}function msSpeak(l,p){var n=document.getElementById(l);null==n&&(n=msGetFlash(l));msIsFlash(n)?n.msSpeak(p):msIsHTML5(n)&&n.ctl.msSpeak(p)}
function msSpeakQueued(l,p){var n=document.getElementById(l);null==n&&(n=msGetFlash(l));msIsFlash(n)?msGetFlash(l).msSpeakQueued(p):msIsHTML5(n)&&n.ctl.msSpeakQueued(p)}function msRespond(l,p){var n=document.getElementById(l);null==n&&(n=msGetFlash(l));msIsFlash(n)?n.msRespond(p):msIsHTML5(n)&&n.ctl.msRespond(p)}function msStart(l){var p=document.getElementById(l);null==p&&(p=msGetFlash(l));msIsFlash(p)?p.msStart():msIsHTML5(p)&&p.ctl.msStart()}
function msStop(l){var p=document.getElementById(l);null==p&&(p=msGetFlash(l));msIsFlash(p)?p.msStop():msIsHTML5(p)&&p.ctl.msStop()}function msGetVariable(l,p){var n=document.getElementById(l);null==n&&(n=msGetFlash(l));if(msIsFlash(n))return n.msGetVariable(p);if(msIsHTML5(n))return n.ctl.msGetVariable(p)}function msSetVariable(l,p,n){var z=document.getElementById(l);null==z&&(z=msGetFlash(l));msIsFlash(z)?z.msSetVariable(p,n):msIsHTML5(z)&&z.ctl.msSetVariable(p,n)}
function msGetVariables(l){l=document.getElementById(l);return msIsHTML5(l)?l.ctl.msGetVariables():{}}function msSetVariables(l,p){var n=document.getElementById(l);msIsHTML5(n)&&n.ctl.msSetVariables(p)}function msSetTraceLevel(l,p){var n=document.getElementById(l);msIsHTML5(n)&&n.msSetTraceLevel(p)}function msStartShieldUp(l){l=document.getElementById(l);return msIsHTML5(l)?l.ctl.msStartShieldUp():!1}
function msRunSequencer(l,p,n){l=document.getElementById(l);msIsHTML5(l)&&l.ctl.msRunSequencer(p,n)};